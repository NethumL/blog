<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>My blog setup with Hugo and Org Mode - Nethum Lamahewage - Thoughts</title><meta name=Description content="Nethum Lamahewage's blog"><meta property="og:title" content="My blog setup with Hugo and Org Mode"><meta property="og:description" content="I set up this static site using Hugo and Org Mode with hosting on GitHub Pages. In this article I go through the how and why"><meta property="og:type" content="article"><meta property="og:url" content="https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-06-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-14T00:00:00+00:00"><meta property="og:site_name" content="Nethum Lamahewage - Thoughts"><meta name=twitter:card content="summary"><meta name=twitter:title content="My blog setup with Hugo and Org Mode"><meta name=twitter:description content="I set up this static site using Hugo and Org Mode with hosting on GitHub Pages. In this article I go through the how and why"><meta name=application-name content="NethumL's blog"><meta name=apple-mobile-web-app-title content="NethumL's blog"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/><link rel=prev href=https://nethuml.github.io/posts/2022/04/pyqt-spellcheck/><link rel=stylesheet href=/css/style.min.0f09bb8ccb706dc39f68c711270f01f65e2a0a77e0690a894ef5d8bc17cb5a5571e827a3b948d0b9c86a809788c336cb.css integrity=sha384-Dwm7jMtwbcOfaMcRJw8B9l4qCnfgaQqJTvXYvBfLWlVx6CejuUjQuchqgJeIwzbL><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload="this.onload=null,this.rel='stylesheet'"><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"My blog setup with Hugo and Org Mode","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/nethuml.github.io\/posts\/2022\/06\/blog-setup-with-hugo-org-mode\/"},"genre":"posts","keywords":"org-mode, hugo","wordcount":4862,"url":"https:\/\/nethuml.github.io\/posts\/2022\/06\/blog-setup-with-hugo-org-mode\/","datePublished":"2022-06-14T00:00:00+00:00","dateModified":"2022-06-14T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Nethum Lamahewage"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Nethum Lamahewage - Thoughts"><span class=header-title-pre><i class='fas fa-terminal'></i></span>home</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/about>About </a><a class=menu-item href=/posts>Posts </a><a class=menu-item href=/tags>Tags </a><a class=menu-item href=/categories>Categories </a><a class=menu-item href=https://github.com/NethumL/nethuml.github.io title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Nethum Lamahewage - Thoughts"><span class=header-title-pre><i class='fas fa-terminal'></i></span>home</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/about title>About</a><a class=menu-item href=/posts title>Posts</a><a class=menu-item href=/tags title>Tags</a><a class=menu-item href=/categories title>Categories</a><a class=menu-item href=https://github.com/NethumL/nethuml.github.io title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">My blog setup with Hugo and Org Mode</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Nethum Lamahewage</a></span>&nbsp;<span class=post-category>included in <a href=/categories/configuration/><i class="far fa-folder fa-fw" aria-hidden=true></i>configuration</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="June 14, 2022">June 14, 2022</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;4862 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;23 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#why-this-article-exists>Why this article exists</a></li><li><a href=#why-i-wanted-a-blog>Why I wanted a blog</a></li><li><a href=#why-medium>Why Medium</a></li><li><a href=#why-not-medium>Why not Medium</a><ul><li><a href=#i-m-used-to-a-different-setup>I&rsquo;m used to a different setup</a></li><li><a href=#problems-with-medium>Problems with Medium</a></li></ul></li><li><a href=#moving-to-a-custom-blog>Moving to a custom blog</a><ul><li><a href=#deciding-on-setup>Deciding on setup</a></li><li><a href=#why-a-static-site-generator>Why a Static Site Generator?</a></li><li><a href=#trying-out-hugo>Trying out Hugo</a></li><li><a href=#final-decisions>Final decisions</a></li></ul></li><li><a href=#hosting>Hosting</a><ul><li><a href=#converting-to-markdown>Converting to Markdown</a></li><li><a href=#deploying>Deploying</a></li></ul></li><li><a href=#how-it-could-be-better>How it could be better</a><ul><li><a href=#reduce-loading-of-heavy-resources>Reduce loading of heavy resources</a></li><li><a href=#related-posts>Related posts</a></li></ul></li><li><a href=#going-forward>Going forward</a><ul><li><a href=#republishing-on-medium>Republishing on Medium</a></li><li><a href=#writing-process>Writing process</a></li><li><a href=#analytics>Analytics</a></li><li><a href=#rolling-my-own>Rolling my own</a></li></ul></li><li><a href=#thanks-to>Thanks to</a><ul><li><a href=#github><a href=https://github.com>GitHub</a></a></li><li><a href=#hugo><a href=https://gohugo.io>Hugo</a></a></li><li><a href=#ox-hugo><a href=https://ox-hugo.scripter.co>ox-hugo</a></a></li><li><a href=#loveit-theme><a href=https://hugoloveit.com>LoveIt theme</a></a></li><li><a href=#org-mode><a href=https://orgmode.org>Org Mode</a></a></li><li><a href=#doom-emacs><a href=https://github.com/doomemacs/doomemacs>Doom Emacs</a></a></li><li><a href=#everyone-else>Everyone else</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=introduction>Introduction</h2><p>I started this site on the 15th of April 2022. However, I wrote my first article on the 11th of May 2021, on Medium. I&rsquo;ve republished it and the second one here, because I want this to be the original source for all my articles.</p><p>Going forward, this is going to be the home for all my articles, so I wanted to write one about how this site came to be.</p><p>Fair warning, this article is a bit long, as you can probably see. This article is not a step-by-step guide of how I setup this site. This is more about my reasoning for why it is the way it is, and some details of how I set up <em>specific</em> things. If you want to know more about the basics of setting up a Hugo site, it would be best to look at their <a href=https://gohugo.io/getting-started target=_blank rel="noopener noreffer">getting started guide</a> or one of the many tutorials already out there.</p><p>Also, I&rsquo;ve included a lot of links in the article. That&rsquo;s partly if readers want to know more about what I&rsquo;ve done or used, and also just to show where I got my information from.</p><h2 id=why-this-article-exists>Why this article exists</h2><p>There are a few major reasons to do this:</p><ol><li>It took a long time to get to this point and I want to write down the process I went through to get here.</li><li>I&rsquo;m hoping that this article will be helpful to someone who&rsquo;s also looking to set up a similar site. For reference, this is a site with the content written in <a href=https://orgmode.org target=_blank rel="noopener noreffer">Org Mode</a> with <a href=https://ox-hugo.scripter.co target=_blank rel="noopener noreffer">ox-hugo</a> powered by <a href=https://gohugo.io target=_blank rel="noopener noreffer">Hugo</a> and hosted on <a href=https://pages.github.com target=_blank rel="noopener noreffer">GitHub Pages</a>.</li><li>It&rsquo;s just kind of what you do when you set up a blog site like this. You write an article about how and why you did it. It&rsquo;s basically a law at this point.</li></ol><h2 id=why-i-wanted-a-blog>Why I wanted a blog</h2><p>Honestly, my main reason to start writing these articles, was because I was told that it would be a helpful for me in the future. Partly to show what I&rsquo;ve done over the years, and also to help me practice putting things into words for other people to read.</p><p>And besides, I&rsquo;m hoping at least some of them are useful to other people as well.</p><h2 id=why-medium>Why Medium</h2><p>The main reason was just that it was recommended to me by others. There&rsquo;s also the fact that it&rsquo;s a large site, so I&rsquo;m likely to have a wider reach by posting there.
On top of that when I wrote my first article on Medium, I didn&rsquo;t really consider any alternatives.</p><h2 id=why-not-medium>Why not Medium</h2><p>For me, there were a few reasons to not use Medium. These may not apply to you, but they bothered me enough to push me to set up a blog myself.</p><h3 id=i-m-used-to-a-different-setup>I&rsquo;m used to a different setup</h3><p>While I don&rsquo;t know if I could be a classified as a vimmer, I do use vim in all the editors/IDEs I use, and even in the <a href=https://github.com/tridactyl/tridactyl target=_blank rel="noopener noreffer">browser</a>. I wrote my first two articles before setting up this site, so they were directly posted to Medium. However, I didn&rsquo;t write those articles in the Medium editor. I wrote them in <a href=https://orgmode.org target=_blank rel="noopener noreffer">Org Mode</a> in <a href=https://github.com/doomemacs/doomemacs target=_blank rel="noopener noreffer">Doom Emacs</a>, because that&rsquo;s my preferred editor for writing.</p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>Info<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>If you&rsquo;re already familiar with either Emacs or Org Mode, you probably don&rsquo;t need me to tell you why. If you&rsquo;re familiar with Markdown, then it might help you to think of Org Mode as Markdown on speed (it&rsquo;s so much more than that, but that should be a good starting point). If you want to know more, checkout the <a href=https://orgmode.org target=_blank rel="noopener noreffer">official website</a> and the <a href=https://orgmode.org/features.html target=_blank rel="noopener noreffer">features page</a>.</div></div></div><p>I&rsquo;ve set up Doom Emacs with vim keybindings, so I can use all of those familiar keybindings, but with all the power of Emacs and Org Mode. Compared to that, I feel that Medium&rsquo;s editor falls short. While it does support basic formatting, quotes, lists, embeds, and some other stuff, it is still lacking. For example, you can add code blocks, but they won&rsquo;t have syntax highlighting. For that, you have to put your code on some other site like GitHub Gists or CodePen, and embed it in the Medium editor. While over here with Org Mode, I get all of those, along with any custom things I want to add.</p><h3 id=problems-with-medium>Problems with Medium</h3><p>Another major issue is the site itself. A disclaimer first: I am still only a CSE student, so maybe I just don&rsquo;t know enough about web development to accurately understand all this, but, here&rsquo;s what I can see and understand.</p><p>According to <a href=https://medium.engineering/the-stack-that-helped-medium-drive-2-6-millennia-of-reading-time-e56801f7c492 target=_blank rel="noopener noreffer">this article</a> on the Medium Engineering blog, they&rsquo;re using their &ldquo;own Single Page Application framework that uses Closure as a standard library&rdquo;. When I load up an article and scroll to the bottom, the Network tab in the Developer Tools says it has transferred somewhere around 3 MB, and after transferring, the total size is above 10 MB. Personally, I think that&rsquo;s too much. You are of course welcome to disagree. But, Medium is, effectively, a site for people to post their ideas in article form, and also read articles written by other people. It allows anyone, not just people with the technical knowledge or time to do it themselves, to write articles and have them be read by people around the world. Most of the content is text, with some images, and sometimes embedded content such as YouTube videos or code (from GitHub Gists for example). It seems to me, that a site like this should be kind of lightweight. However, it&rsquo;s clearly not. If I go to any random article, it takes about 3 seconds to load (depending on the article). I know that&rsquo;s not the end of the world, but I generally try to avoid sites like that. It also seems a bit slow when reading articles. I should mention that my internet connection, while not exceedingly fast, is reasonably fast, but Medium still seems a bit slow on it.</p><p>Side note, while writing this part of this post, I went on Medium to test its speed and network usage, and it turns out I used quite a bit of data just doing that. Some time after I had properly started looking into setting up my own blog, I remember clicking on a link to a Medium article about something, and the actual <em>content</em> of the article was the <em>last</em> to load. I don&rsquo;t know about you, but I think that&rsquo;s a bit too far.</p><p>There are other minor issues (not necessarily specific to Medium), such as the risk that my profile might suddenly be deleted, or that they could just stop running the site (<a href=https://en.wikipedia.org/wiki/Vendor_lock-in target=_blank rel="noopener noreffer">vendor lock-in</a>), and so on.</p><h2 id=moving-to-a-custom-blog>Moving to a custom blog</h2><h3 id=deciding-on-setup>Deciding on setup</h3><p>When I was looking around for alternatives, I did briefly consider <a href=https://dev.to target=_blank rel="noopener noreffer">DEV</a>, as it doesn&rsquo;t seem to have the same performance issues, and according to their <a href=https://dev.to/p/editor_guide target=_blank rel="noopener noreffer">Editor Guide</a>, they use Markdown along with some other niceties. A minor issue is that it seems to be a community for developers. The problem with that is, my articles aren&rsquo;t necessarily targeted at developers. For instance, my article about <a href=https://nethuml.github.io/posts/2022/04/hammerspoon-global-leader-key/ rel>setting up a global leader key in hammerspoon</a> is not for developers. It&rsquo;s for macOS users who like to customise their systems. Similarly, I would probably be posting articles that are even less aimed at developers, so I didn&rsquo;t go with DEV.</p><p>However, I do have a tendency to try more custom options, so I looked into <a href=https://www.cloudflare.com/en-gb/learning/performance/static-site-generator target=_blank rel="noopener noreffer">static site generators</a> (SSGs). I had previously checked out <a href=https://jekyllrb.com target=_blank rel="noopener noreffer">Jekyll</a> for something else, and I think I was aware of <a href=https://gohugo.io target=_blank rel="noopener noreffer">Hugo</a>. After some consideration, I decided to go with Hugo. It&rsquo;s been some time since I made the decision, but I think it was because it was better suited for use with Org Mode, but don&rsquo;t quote me on that.</p><h3 id=why-a-static-site-generator>Why a Static Site Generator?</h3><p>Before I get into my experience in trying out Hugo and eventually setting up this site, I should probably go over why I decided to go with a static site generator. The blog sites I have seen are generally web-apps. I&rsquo;m referring to the dynamic nature of them. They provide their own editor to write articles and when you go to the page for a specific article, they load the article contents from a database and generate the page on the fly/on request. Some have a backend API and a frontend framework that communicate, and the frontend framework builds the HTML that the browser then renders. With all this processing work, it does take some time. And since there&rsquo;s a frontend framework involved, it will take some time to build the page. I&rsquo;m not going to go into the pros and cons of using a frontend framework here. This isn&rsquo;t the article for that, and besides, there&rsquo;s enough discussion about that already.</p><p>My issue with that setup for a blog site is, I would prefer to have better performance given that is it a <span class=underline>blog site</span>. I understand that to cater to the general public, it pretty much needs to be dynamic, so this setup is almost inevitable (note that I said <em>almost</em>, because for all I know there&rsquo;s a successful site out there that does things differently). But for me, I&rsquo;m fine with a bit more setup time. I can invest the time it would take me to setup a system that works for me.</p><p>Using a static site means that when someone goes to a page, the browser simply fetches HTML from the server and then processes it. All the content is right there. Any code that it needs to parse and evaluate can be strictly for functional purposes (eg: folding content, search, clipboard).</p><p>I&rsquo;ve already mentioned that I prefer to write in Org Mode. I also prefer to have control over my content, and using a static site generator would give me that. I could style the website however I want (I know I haven&rsquo;t done that yet, but the option is available) and adjust it to suit my needs.</p><h3 id=trying-out-hugo>Trying out Hugo</h3><p>I didn&rsquo;t have any experience with Hugo, so I wanted to first try it out separately before I started making my actual blog with it. For that purpose, I set up a test site with some dummy posts. I used it to try out the various things I would need, such as:</p><ul><li>Normal markup</li><li>Links between posts</li><li>Code blocks</li><li>Diagrams</li></ul><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>About the following section<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>At this point, I was using the <a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng target=_blank rel="noopener noreffer">Hello Friend NG</a> theme, so most of the following information is specific to that theme.</div></div></div><p>I setup a site using the <a href=https://gohugo.io/getting-started target=_blank rel="noopener noreffer">getting started guide</a>, then spent some time messing around with it</p><h4 id=normal-markup>Normal markup</h4><p>There&rsquo;s not really anything to say for this. I can just use the Org Mode markup that I&rsquo;m used to.</p><h4 id=links-between-posts>Links between posts</h4><p>I was hoping that I would be able to use normal org-mode links, but those didn&rsquo;t work because of the way ox-hugo works. Instead, I used Hugo&rsquo;s <a href=https://gohugo.io/content-management/cross-references/#use-ref-and-relref target=_blank rel="noopener noreffer">ref and relref shortcodes</a>. As an aside: there are a lot of <a href=https://gohugo.io/content-management/shortcodes/#use-hugos-built-in-shortcodes target=_blank rel="noopener noreffer">built-in shortcodes</a> that are really useful.</p><h4 id=equations--latex>Equations (LaTeX)</h4><p>Given that this is a website, my first thought was to use <a href=https://www.mathjax.org target=_blank rel="noopener noreffer">MathJax</a>. At the time, I was testing out the <a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng target=_blank rel="noopener noreffer">Hello Friend NG</a> theme, and in that, I just added a bit of extra HTML to the head to include a link to the MathJax CDN.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/partials/mathjax.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- Config --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ &#34;</span><span class=na>js</span><span class=err>/</span><span class=na>mathjax-config</span><span class=err>.</span><span class=na>js</span><span class=err>&#34;</span> <span class=err>|</span> <span class=na>absURL</span> <span class=err>}}&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- CDN link for MathJax --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://polyfill.io/v3/polyfill.min.js?features=es6&#34;</span> <span class=na>integrity</span><span class=o>=</span><span class=s>&#34;sha384-1/AagWQhAo3drUi4tSBCeroqfpVVIw36CDyuqV03iQ5NJwW2adh8PLrZekInk8c+&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;MathJax-script&#34;</span> <span class=na>async</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js&#34;</span> <span class=na>integrity</span><span class=o>=</span><span class=s>&#34;sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>and for MathJax, I added this config in static/js</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/* static/js/mathjax-config.js */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>MathJax</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>loader</span><span class=o>:</span> <span class=p>{</span><span class=nx>load</span><span class=o>:</span> <span class=p>[]},</span>
</span></span><span class=line><span class=cl>  <span class=nx>tex</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>packages</span><span class=o>:</span> <span class=p>{</span><span class=s1>&#39;[+]&#39;</span><span class=o>:</span> <span class=p>[]}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>I also wanted to include <a href=https://mermaid-js.github.io/mermaid target=_blank rel="noopener noreffer">Mermaid</a> and <a href=https://github.com/pgf-tikz/pgf target=_blank rel="noopener noreffer">TikZ</a> (using <a href=https://tikzjax.com target=_blank rel="noopener noreffer">TikZJax</a>), so I wrote a bit of Go template to make it easier to add more such &ldquo;addons&rdquo; and enable them per post as required.
And to add them to the head, I made use of the Hello Friend NG theme&rsquo;s <code>extra-head.html</code> partial</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/partials/extra-head.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>{{ range $addon := .Params.addons }}
</span></span><span class=line><span class=cl>    {{ partial $addon &#34;.html&#34; . }}
</span></span><span class=line><span class=cl>{{ end }}
</span></span></code></pre></div><p>To enable specific addons in a post, I just set it in the front matter through <a href=https://ox-hugo.scripter.co/doc/custom-front-matter/#single-value-parameters target=_blank rel="noopener noreffer">this property</a> in ox-hugo</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl>:EXPORT_HUGO_CUSTOM_FRONT_MATTER: :addons &#39;(&#34;mathjax&#34; &#34;tikz&#34;)
</span></span></code></pre></div><h4 id=diagrams--mermaid>Diagrams (Mermaid)</h4><p>For Mermaid, I had to include the CDN and enable mermaid as well, following <a href=https://gohugo.io/content-management/diagrams/#mermaid-diagrams target=_blank rel="noopener noreffer">this part</a> of the Hugo docs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/partials/mermaid.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/mermaid@9.1.1/dist/mermaid.min.js&#34;</span> <span class=na>integrity</span><span class=o>=</span><span class=s>&#34;sha256-8L3O8tirFUa8Va4NSTAyIbHJeLd6OnlcxgupV9F77e0=&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nx>mermaid</span><span class=p>.</span><span class=nx>initialize</span><span class=p>({</span> <span class=nx>startOnLoad</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/_default/_markup/render-codeblock-mermaid.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;mermaid&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  {{- .Inner | safeHTML }}
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>{{ .Page.Store.Set &#34;hasMermaid&#34; true }}
</span></span></code></pre></div><p>And to use it in org-mode, I used source code blocks.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl><span class=c>#+BEGIN_SRC </span><span class=cs>mermaid</span><span class=c>
</span></span></span><span class=line><span class=cl><span class=c></span>graph TD;
</span></span><span class=line><span class=cl>    A--&gt;B;
</span></span><span class=line><span class=cl>    A--&gt;C;
</span></span><span class=line><span class=cl>    B--&gt;D;
</span></span><span class=line><span class=cl>    C--&gt;D;
</span></span><span class=line><span class=cl><span class=c>#+END_SRC</span>
</span></span></code></pre></div><h4 id=diagrams--goat>Diagrams (GoAT)</h4><p>Hugo supports <a href=https://github.com/bep/goat target=_blank rel="noopener noreffer">GoAT</a> natively, according to <a href=https://gohugo.io/content-management/diagrams/#goat-diagrams-ascii target=_blank rel="noopener noreffer">this</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl><span class=c>#+BEGIN_SRC </span><span class=cs>goat</span><span class=c>
</span></span></span><span class=line><span class=cl><span class=c></span>      .               .                .               .--- 1          .-- 1     / 1
</span></span><span class=line><span class=cl>     / \              |                |           .---+            .-+         +
</span></span><span class=line><span class=cl>    /   \         .---+---.         .--+--.        |   &#39;--- 2      |   &#39;-- 2   / \ 2
</span></span><span class=line><span class=cl>   +     +        |       |        |       |    ---+            ---+          +
</span></span><span class=line><span class=cl>  / \   / \     .-+-.   .-+-.     .+.     .+.      |   .--- 3      |   .-- 3   \ / 3
</span></span><span class=line><span class=cl> /   \ /   \    |   |   |   |    |   |   |   |     &#39;---+            &#39;-+         +
</span></span><span class=line><span class=cl> 1   2 3   4    1   2   3   4    1   2   3   4         &#39;--- 4          &#39;-- 4     \ 4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#+END_SRC</span>
</span></span></code></pre></div><h4 id=diagrams--tikz>Diagrams (TikZ)</h4><p>Thanks to <a href=https://tikzjax.com target=_blank rel="noopener noreffer">TikZJax</a>, it&rsquo;s possible to use TikZ diagrams on the web. While I&rsquo;m unlikely to use TikZ (given that most of my articles are going to be about programming and technology), I had used <a href=https://github.com/circuitikz/circuitikz target=_blank rel="noopener noreffer">CircuiTikZ</a> before (for some of my university notes), so I wanted to try it just because. Using it was as easy as adding a couple of links to the CSS and JS to the <code>head</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=c>&lt;!-- layouts/partials/mermaid.html --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/css&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;https://tikzjax.com/v1/fonts.css&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://tikzjax.com/v1/tikzjax.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>To draw TikZ diagrams, you just do this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl><span class=c>#+begin_tikzjax</span>
</span></span><span class=line><span class=cl>\draw (0,0) circle (1in);
</span></span><span class=line><span class=cl><span class=c>#+end_tikzjax</span>
</span></span></code></pre></div><h4 id=rss-feed>RSS feed</h4><p>I didn&rsquo;t really need to do anything for this. It just works.</p><h3 id=final-decisions>Final decisions</h3><p>At this point, I had got basically everything working that I wanted. I had also figured out the deployment process by then, but I&rsquo;ll get to that in the next topic. I was in the process of making my actual site, when I started having second thoughts about the theme (it was <a href=https://github.com/rhazdon/hugo-theme-hello-friend-ng target=_blank rel="noopener noreffer">Hello Friend NG</a> at this point). It&rsquo;s a nice theme, but I just wasn&rsquo;t feeling it. There was also the fact that I hadn&rsquo;t looked at that many themes before deciding on it. That didn&rsquo;t sit right with me, so I spent some more time (read <em>procrastinated</em>) looking at many other themes. I installed a few and tried them out, before I found the <a href=https://hugoloveit.com target=_blank rel="noopener noreffer">LoveIt theme</a>. It had basically everything I wanted, and I liked the look of it. It&rsquo;s not perfect of course. I would have preferred if it was a bit lighter. Compared to other sites, it&rsquo;s light, but compared to minimal sites, it&rsquo;s not (it does well on normal scales, but I think I would be happier with a more minimal one). I can live with that, for now. Everything else is great.</p><p>It took some time to configure it to my liking, but I eventually did. I&rsquo;m not going to go into that part. I don&rsquo;t think it would be that interesting, and besides, you can see the <a href=https://github.com/NethumL/nethuml.github.io/blob/main/config.toml target=_blank rel="noopener noreffer">config.toml</a> in the source repository. Due to some of the stuff I had already done being specific to my previous theme, I had to spend some time dealing with that.</p><p>Enabling equations using <a href=https://katex.org target=_blank rel="noopener noreffer">KaTeX</a> was as simple as adding this line in the source.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl>:EXPORT_HUGO_CUSTOM_FRONT_MATTER: :math &#39;((&#34;enable&#34; . t))
</span></span></code></pre></div><p>Mermaid support was built-in. I had to use the shortcode like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl><span class=c>#+BEGIN_EXPORT </span><span class=cs>hugo</span>
</span></span><span class=line><span class=cl>{{&lt; mermaid &gt;}}
</span></span><span class=line><span class=cl>graph TD;
</span></span><span class=line><span class=cl>    A--&gt;B;
</span></span><span class=line><span class=cl>    A--&gt;C;
</span></span><span class=line><span class=cl>    B--&gt;D;
</span></span><span class=line><span class=cl>    C--&gt;D;
</span></span><span class=line><span class=cl>{{&lt; /mermaid &gt;}}
</span></span><span class=line><span class=cl><span class=c>#+END_EXPORT</span>
</span></span></code></pre></div><p>To enable TikZJax, I need to add the links to the front matter, using ox-hugo&rsquo;s <a href=https://ox-hugo.scripter.co/doc/custom-front-matter/#front-matter-extra target=_blank rel="noopener noreffer">extra front matter</a> feature.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl><span class=c>#+BEGIN_SRC </span><span class=cs>toml</span><span class=c> :front_matter_extra t :noeval
</span></span></span><span class=line><span class=cl><span class=c></span><span class=p>[</span><span class=nx>library</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nx>library</span><span class=p>.</span><span class=nx>css</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=nx>tikz</span> <span class=p>=</span> <span class=s2>&#34;https://tikzjax.com/v1/fonts.css&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nx>library</span><span class=p>.</span><span class=nx>js</span><span class=p>]</span>
</span></span><span class=line><span class=cl>      <span class=nx>tikz</span> <span class=p>=</span> <span class=s2>&#34;https://tikzjax.com/v1/tikzjax.js&#34;</span>
</span></span><span class=line><span class=cl><span class=c>#+END_SRC</span>
</span></span></code></pre></div><p>The LoveIt theme also came with support for two search systems: <a href=https://lunrjs.com target=_blank rel="noopener noreffer">Lunr</a> and <a href=https://www.algolia.com target=_blank rel="noopener noreffer">Algolia</a>. Lunr seemed to be easier to setup, so I used that.</p><p>There are some other bonus features, such as being able to add charts using <a href=https://echarts.apache.org target=_blank rel="noopener noreffer">ECharts</a> like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-org data-lang=org><span class=line><span class=cl><span class=c>#+BEGIN_EXPORT </span><span class=cs>hugo</span>
</span></span><span class=line><span class=cl>{{&lt; echarts &gt;}}
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;title&#34;: { &#34;text&#34;: &#34;Summary Line Chart&#34;, &#34;top&#34;: &#34;2%&#34;, &#34;left&#34;: &#34;center&#34; },
</span></span><span class=line><span class=cl>  &#34;tooltip&#34;: { &#34;trigger&#34;: &#34;axis&#34; },
</span></span><span class=line><span class=cl>  &#34;legend&#34;: { &#34;data&#34;: [&#34;Email Marketing&#34;, &#34;Affiliate Advertising&#34;, &#34;Video Advertising&#34;, &#34;Direct View&#34;, &#34;Search Engine&#34;], &#34;top&#34;: &#34;10%&#34; },
</span></span><span class=line><span class=cl>  &#34;grid&#34;: { &#34;left&#34;: &#34;5%&#34;, &#34;right&#34;: &#34;5%&#34;, &#34;bottom&#34;: &#34;5%&#34;, &#34;top&#34;: &#34;20%&#34;, &#34;containLabel&#34;: true },
</span></span><span class=line><span class=cl>  &#34;toolbox&#34;: { &#34;feature&#34;: { &#34;saveAsImage&#34;: { &#34;title&#34;: &#34;Save as Image&#34; } } },
</span></span><span class=line><span class=cl>  &#34;xAxis&#34;: { &#34;type&#34;: &#34;category&#34;, &#34;boundaryGap&#34;: false, &#34;data&#34;: [&#34;Monday&#34;, &#34;Tuesday&#34;, &#34;Wednesday&#34;, &#34;Thursday&#34;, &#34;Friday&#34;, &#34;Saturday&#34;, &#34;Sunday&#34;] },
</span></span><span class=line><span class=cl>  &#34;yAxis&#34;: { &#34;type&#34;: &#34;value&#34; },
</span></span><span class=line><span class=cl>  &#34;series&#34;: [
</span></span><span class=line><span class=cl>    { &#34;name&#34;: &#34;Email Marketing&#34;, &#34;type&#34;: &#34;line&#34;, &#34;stack&#34;: &#34;Total&#34;, &#34;data&#34;: [120, 132, 101, 134, 90, 230, 210] },
</span></span><span class=line><span class=cl>    { &#34;name&#34;: &#34;Affiliate Advertising&#34;, &#34;type&#34;: &#34;line&#34;, &#34;stack&#34;: &#34;Total&#34;, &#34;data&#34;: [220, 182, 191, 234, 290, 330, 310] },
</span></span><span class=line><span class=cl>    { &#34;name&#34;: &#34;Video Advertising&#34;, &#34;type&#34;: &#34;line&#34;, &#34;stack&#34;: &#34;Total&#34;, &#34;data&#34;: [150, 232, 201, 154, 190, 330, 410] },
</span></span><span class=line><span class=cl>    { &#34;name&#34;: &#34;Direct View&#34;, &#34;type&#34;: &#34;line&#34;, &#34;stack&#34;: &#34;Total&#34;, &#34;data&#34;: [320, 332, 301, 334, 390, 330, 320] },
</span></span><span class=line><span class=cl>    { &#34;name&#34;: &#34;Search Engine&#34;, &#34;type&#34;: &#34;line&#34;, &#34;stack&#34;: &#34;Total&#34;, &#34;data&#34;: [820, 932, 901, 934, 1290, 1330, 1320] }
</span></span><span class=line><span class=cl>  ]
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>{{&lt; /echarts &gt;}}
</span></span><span class=line><span class=cl><span class=c>#+END_EXPORT</span>
</span></span></code></pre></div><p>There are even more useful features as you can see <a href=https://github.com/dillonzq/LoveIt/#features target=_blank rel="noopener noreffer">here</a>.</p><h2 id=hosting>Hosting</h2><p>An important thing I had to figure out was how to set up the site. I was already looking into using GitHub Pages for this, but I had never done that before, so it took some time. Most of the other Hugo users were using Markdown, so they just set up a GitHub workflow to build the site from the markdown source, but I was using Org Mode for the source. Locally, I exported it to Markdown using ox-hugo, and built the site using Hugo. Most of the ones I found that were also using ox-hugo were exporting to Markdown locally and putting that in the repository to be used in the workflow. I didn&rsquo;t want to do that, because I only wanted the Org Mode version to be in repository, considering that it was the actual <em>source</em> for the website. I found <a href=https://github.com/HaoZeke/haozeke.github.io target=_blank rel="noopener noreffer">one website</a> that seemed to be doing what I wanted, but their setup seemed to be quite complicated, using nix and Rakefiles and stuff. I wasn&rsquo;t familiar with them, so it took me a while to figure out exactly what I needed to do. I eventually did, and with a <em>lot</em> of trial and error, I managed it.</p><p>I&rsquo;ll briefly explain how my system works, and then I&rsquo;ll show the build process. The content is all in org-mode, and at the time of writing, all contained within the <code>all-posts.org</code> file. Locally, I have the <a href=https://ox-hugo.scripter.co target=_blank rel="noopener noreffer">ox-hugo</a> package installed in my Emacs, and I export to .md, then run Hugo to build the site. But on GitHub pages, I need to automate it with <a href=https://github.com/features/actions target=_blank rel="noopener noreffer">GitHub Actions</a>. Like I said, I wanted the site to be generated from the source, without me committing the intermediate .md into the repository. So, that means there are two main steps. First, I need to convert from .org to .md. Then, I can run Hugo. Running Hugo in GitHub Actions was easy. I found the <a href=https://github.com/peaceiris/actions-hugo target=_blank rel="noopener noreffer">peaceiris/actions-hugo</a> action to setup Hugo in the workflow, and then I could just run <code>hugo --minify</code> in a separate step to build the site. Converting to .md was the issue. I needed to setup Emacs for that, which by itself, is almost trivial thanks to <a href=https://github.com/purcell/setup-emacs target=_blank rel="noopener noreffer">purcell/setup-emacs</a>. However, I also need to setup the required environment within Emacs, because I need to install some packages and configure Emacs a bit before it can do what I want. This took a lot of time to do properly. I wrote a short shell script that calls Emacs and runs an Emacs Lisp file that does the actual work. After that&rsquo;s done, Hugo can take over.</p><h3 id=converting-to-markdown>Converting to Markdown</h3><p>You can see the actual contents of the <a href=https://github.com/NethumL/nethuml.github.io/blob/main/publish.el target=_blank rel="noopener noreffer">script</a> on the repository, so here I&rsquo;ll split it into sections and explain.</p><p>First, I need to prepare the Emacs package manager and install some packages.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Prepare package manager</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;package</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>package-initialize</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>unless</span> <span class=nv>package-archive-contents</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;package-archives</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;nongnu&#34;</span> <span class=o>.</span> <span class=s>&#34;https://elpa.nongnu.org/nongnu/&#34;</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>add-to-list</span> <span class=ss>&#39;package-archives</span> <span class=o>&#39;</span><span class=p>(</span><span class=s>&#34;melpa&#34;</span> <span class=o>.</span> <span class=s>&#34;https://melpa.org/packages/&#34;</span><span class=p>)</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>package-refresh-contents</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Install packages if not installed already</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>dolist</span> <span class=p>(</span><span class=nv>pkg</span> <span class=o>&#39;</span><span class=p>(</span><span class=nv>org-contrib</span> <span class=nv>ox-hugo</span> <span class=nv>plantuml-mode</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>package-installed-p</span> <span class=nv>pkg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nv>package-install</span> <span class=nv>pkg</span><span class=p>)))</span>
</span></span></code></pre></div><p>Then, I load the packages and configure them</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=c1>;; Load packages</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;org</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;ox-hugo</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Prepare plantuml</span>
</span></span><span class=line><span class=cl><span class=c1>;; This is for future use</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>require</span> <span class=ss>&#39;plantuml-mode</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-plantuml-jar-path</span> <span class=nv>plantuml-jar-path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>defadvice</span> <span class=nv>plantuml-download-jar</span> <span class=p>(</span><span class=nv>around</span> <span class=nv>auto-confirm</span> <span class=nv>compile</span> <span class=nv>activate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>cl-letf</span> <span class=p>(((</span><span class=nf>symbol-function</span> <span class=ss>&#39;yes-or-no-p</span><span class=p>)</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>args</span><span class=p>)</span> <span class=no>t</span><span class=p>))</span>
</span></span><span class=line><span class=cl>	    <span class=p>((</span><span class=nf>symbol-function</span> <span class=ss>&#39;y-or-n-p</span><span class=p>)</span> <span class=p>(</span><span class=nb>lambda</span> <span class=p>(</span><span class=kp>&amp;rest</span> <span class=nv>args</span><span class=p>)</span> <span class=no>t</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    <span class=nv>ad-do-it</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>plantuml-download-jar</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>;; Prepare org-babel</span>
</span></span><span class=line><span class=cl><span class=c1>;; This is for any code blocks need to be evaluated</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nb>setq</span> <span class=nv>org-confirm-babel-evaluate</span> <span class=no>nil</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=nv>org-babel-do-load-languages</span>
</span></span><span class=line><span class=cl> <span class=ss>&#39;org-babel-load-languages</span>
</span></span><span class=line><span class=cl> <span class=o>&#39;</span><span class=p>((</span><span class=nv>plantuml</span> <span class=o>.</span> <span class=no>t</span><span class=p>)</span> <span class=p>(</span><span class=nv>python</span> <span class=o>.</span> <span class=no>t</span><span class=p>)))</span>
</span></span></code></pre></div><p>And here is the actual publishing function. It executes the buffer with <code>org-babel</code> and then exports to Markdown. I&rsquo;m using <code>org-hugo-export-wim-to-md</code> which will run the correct export process based on context.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-emacs-lisp data-lang=emacs-lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>npl-publish-all</span> <span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Publishing from emacs...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-babel-execute-buffer</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nv>org-hugo-export-wim-to-md</span> <span class=no>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nf>message</span> <span class=s>&#34;Finished exporting to markdown&#34;</span><span class=p>))</span>
</span></span></code></pre></div><p>That was the content of <code>publish.el</code>. Here is the <code>build.sh</code> shell script that runs the elisp.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Running build script&#34;</span>
</span></span><span class=line><span class=cl>mkdir -p content-org/images/generated
</span></span><span class=line><span class=cl>emacs --batch --no-init-file --load publish.el content-org/all-posts.org --funcall npl-publish-all
</span></span></code></pre></div><p>It just loads <code>publish.el</code> and then calls the <code>npl-publish-all</code> function on the <code>all-posts.org</code> file. It also creates a folder for any images that <code>org-babel</code> may generate.</p><h3 id=deploying>Deploying</h3><p>The entire process is &ldquo;pieced together&rdquo; by the <a href=https://github.com/NethumL/nethuml.github.io/blob/main/.github/workflows/build.yml target=_blank rel="noopener noreffer">workflow file</a>. Most of it is self-explanatory, and you could probably figure it out by referring the <a href=https://docs.github.com/en/actions/using-workflows/about-workflows target=_blank rel="noopener noreffer">GitHub documentation for workflows</a>.</p><p>There&rsquo;s one important part in the workflow file though.</p><p>There&rsquo;s this bit in the &ldquo;on&rdquo; section:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>workflow_dispatch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>inputs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>debug_enabled</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Start the SSH session for interactive debugging&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>required</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>default</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span></code></pre></div><p>and this bit in the middle of the job:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Start SSH session</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>luchihoratiu/debug-via-ssh@main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>if</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.event_name == &#39;workflow_dispatch&#39; &amp;&amp; github.event.inputs.debug_enabled }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>NGROK_AUTH_TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.NGROK_AUTH_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>SSH_PASS</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.SSH_PASS }}</span><span class=w>
</span></span></span></code></pre></div><p>Those were added for debugging purposes. If a build fails only on GitHub and I&rsquo;m having trouble figuring out why, I can manually trigger the workflow, setting the <code>debug_enabled</code> input to <code>true</code>, and use <a href=https://ngrok.com target=_blank rel="noopener noreffer">ngrok</a> to remote into the container where the workflow is running. There, I can try to interactively run commands to try and figure out what&rsquo;s wrong. At some point, I think I also tried <a href=https://github.com/mxschmitt/action-tmate target=_blank rel="noopener noreffer">tmate</a>, but it didn&rsquo;t work out. I can&rsquo;t remember why though. For all I know, I was doing something wrong.</p><p>Anyway, for more information about this way of debugging, refer the <a href=https://github.com/luchihoratiu/debug-via-ssh target=_blank rel="noopener noreffer">luchihoratiu/debug-via-ssh</a> action. Make sure to set the mentioned secrets for the actions through GitHub&rsquo;s repository settings. Refer the <a href=https://docs.github.com/en/actions/security-guides/encrypted-secrets target=_blank rel="noopener noreffer">documentation</a> for more information.</p><h2 id=how-it-could-be-better>How it could be better</h2><h3 id=reduce-loading-of-heavy-resources>Reduce loading of heavy resources</h3><p>Right now, there&rsquo;s a bit more resources being loaded by the site than I would prefer. The two largest ones are font files for FontAwesome. The thing is, I&rsquo;m barely using them on my website, and there&rsquo;s probably a good way to load only the parts that are actually being used.</p><p>In addition to that, there&rsquo;s also quite a bit of JavaScript, for things such as clipboard, animations, searching, etc. While these are legitimately useful features, I would prefer to have them load when required. Again, there&rsquo;s probably a simple way to do that, and I&rsquo;ll have to look into that. Right now, I think I can live with this setup.</p><h3 id=related-posts>Related posts</h3><p>There&rsquo;s no good way (at least as far as I can tell) to add links to related posts at the bottom of an article. I know I could just add normal links, but I would like to have them be presented nicely. That&rsquo;s something I intend to look into eventually (a <a href=https://gohugo.io/content-management/shortcodes target=_blank rel="noopener noreffer">shortcode</a> is probably the simplest answer).</p><h2 id=going-forward>Going forward</h2><h3 id=republishing-on-medium>Republishing on Medium</h3><p>I plan on republishing <em>some</em> of my posts on Medium as well. Medium still has the advantage of being a large site used by many people, so it will likely have a much wider reach than my own.</p><p>I will probably only do that for posts that I think are worth going through the bother of copying over to Medium.</p><h3 id=writing-process>Writing process</h3><p>As I&rsquo;ve already mentioned, I&rsquo;m using Emacs to write this blog. More specifically, I&rsquo;m using <a href=https://bitbucket.org/mituharu/emacs-mac target=_blank rel="noopener noreffer">emacs-mac</a> with <a href=https://github.com/doomemacs/doomemacs target=_blank rel="noopener noreffer">Doom Emacs</a>. When writing, I generally have Firefox running as well, because I often need to refer other websites to make sure I&rsquo;m accurate. And of course since this is a website, I have the Hugo server running in the background with the preview of the current post in a separate tab.</p><h3 id=analytics>Analytics</h3><p>One of the things that Medium offers is analytics about my articles. I can view detailed statistics about views, reads, traffic sources, etc. As it stands now, this site doesn&rsquo;t have any of that. It&rsquo;s a statically generated site, and the JavaScript that it includes are for functional purposes. It&rsquo;s hosted on GitHub Pages as well, and as far as I&rsquo;m aware, they don&rsquo;t provide any analytics functionality, which makes sense. It&rsquo;s supposed to be just for hosting.</p><p>It would of course be possible for me to integrate some sort of analytics, but I&rsquo;m not sure I want to do that. The reason is, by doing that, I enter into the realm of tracking my readers. Even if it was simply counting numbers of views, I&rsquo;m not sure I want that on my site. This is just where I stand right now. I&rsquo;m a bit wary of that stuff, and at least to start with, want to keep my site simple.</p><p>Say I was fine with that. There&rsquo;s still the issue of how I would do that. One of the most common services is Google Analytics, but that&rsquo;s definitely not something I want on my site. There are other more privacy respecting services, but right now, I&rsquo;m going to keep this site analytics free (from my side at least).</p><h3 id=rolling-my-own>Rolling my own</h3><p>I&rsquo;m a developer (mainly as a hobby and as a student at the time of writing), so I would like to actually make the site myself. Right now, I&rsquo;m using Hugo with a theme that someone else made. I would prefer to either write my own theme, or to do the whole thing myself. I&rsquo;m not actually sure which one would be harder. On the one hand, I&rsquo;m not familiar with Hugo themes, so that would take me some time to learn and implement. On the other, even though I do have some practice with web development, handling the whole process of generating the site would probably take a while, especially considering I need to do all the styling myself and also setup the conversion of the actual articles to HTML.</p><p>I fully intend to actually go through with this, but like I said before, I&rsquo;m satisfied with the current setup, and I&rsquo;m kind of busy these days. It would be a nice challenge though, so I&rsquo;m looking forward to when I can properly sink some time into that project.</p><h2 id=thanks-to>Thanks to</h2><p>There are a few people that I need to thank, without whom this site probably wouldn&rsquo;t exist. I&rsquo;ve attached links on the headings in this section to their websites/webpages.</p><h3 id=github><a href=https://github.com target=_blank rel="noopener noreffer">GitHub</a></h3><p>The source of the site is hosted as a GitHub <a href=https://github.com/NethumL/nethuml.github.io target=_blank rel="noopener noreffer">repository</a>. GitHub Actions are used to <a href=https://github.com/NethumL/nethuml.github.io/actions target=_blank rel="noopener noreffer">build and deploy</a> the site. The site is also hosted on <a href=https://pages.github.com target=_blank rel="noopener noreffer">GitHub Pages</a>.</p><h3 id=hugo><a href=https://gohugo.io target=_blank rel="noopener noreffer">Hugo</a></h3><p>I&rsquo;m using Hugo to generate the HTML for this site. I&rsquo;m not going into all the reasons to choose this SSG over others, because that&rsquo;s not what this post is about, but, thank you to the developers/contributors of Hugo, and the community around it.</p><h3 id=ox-hugo><a href=https://ox-hugo.scripter.co target=_blank rel="noopener noreffer">ox-hugo</a></h3><p>This is for exporting the Org Mode source to Markdown to be used by Hugo. Hugo does support Org Mode directly, but I didn&rsquo;t want to risk missing out on some feature that Hugo had only implemented for Markdown.</p><h3 id=loveit-theme><a href=https://hugoloveit.com target=_blank rel="noopener noreffer">LoveIt theme</a></h3><p>This is the theme that I eventually settled on, after going through a few others. It has all the features I need and many more that I never even considered, and it looks good as well.</p><h3 id=org-mode><a href=https://orgmode.org target=_blank rel="noopener noreffer">Org Mode</a></h3><p>I already talked a bit about it before; this was one of my main reasons to switch to this setup. I feel right at home writing in Org Mode, whether it&rsquo;s quick little notes, complete notes for university, task management, or articles like this.</p><h3 id=doom-emacs><a href=https://github.com/doomemacs/doomemacs target=_blank rel="noopener noreffer">Doom Emacs</a></h3><p>Doom Emacs was my entry point into Emacs. It&rsquo;s an easy way to get into Emacs, and it provides a lot of stuff out of the box that you would normally have to manually configure in Emacs. Without this, I probably would not have started using Emacs and Org Mode.</p><h3 id=everyone-else>Everyone else</h3><p>There&rsquo;s probably other people I&rsquo;ve missed. Actually scratch that. There&rsquo;s definitely other people I&rsquo;ve missed, such as the writers of all the articles and posts I read to figure out what I needed to set this whole thing up and many others. These are just the ones I can directly point out and the ones that came to mind while writing this.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on June 14, 2022</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-title="My blog setup with Hugo and Org Mode" data-hashtags=org-mode,hugo><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-hashtag=org-mode><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-title="My blog setup with Hugo and Org Mode" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Pinterest" data-sharer=pinterest data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/><i class="fab fa-pinterest fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Tumblr" data-sharer=tumblr data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-title="My blog setup with Hugo and Org Mode" data-tags=org-mode,hugo><i class="fab fa-tumblr fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-title="My blog setup with Hugo and Org Mode"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-title="My blog setup with Hugo and Org Mode"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.0.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on " data-sharer=weibo data-url=https://nethuml.github.io/posts/2022/06/blog-setup-with-hugo-org-mode/ data-title="My blog setup with Hugo and Org Mode"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/org-mode/>org-mode</a>,&nbsp;<a href=/tags/hugo/>hugo</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2022/04/pyqt-spellcheck/ class=prev rel=prev title="Integrating spellchecking into a PyQt5 QTextEdit widget with enchant"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Integrating spellchecking into a PyQt5 QTextEdit widget with enchant</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.100.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Nethum Lamahewage</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.9d752da052ce4f1dc37d3efc92c6dfdfb5a27549b5bfd32638c6d1a07f7e7781df6acee2cd67a906221a7c80c8b9639d.js integrity=sha384-nXUtoFLOTx3DfT78ksbf37WidUm1v9MmOMbRoH9+d4Hfas7izWepBiIafIDIuWOd></script><script data-goatcounter=https://nethuml-github-io.goatcounter.com/count async src=//gc.zgo.at/count.v3.js></script></body></html>